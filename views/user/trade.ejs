<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Trade - Trading Platform</title>
  <link rel="stylesheet" href="/css/styles.css">
  <link href="https://i.imgur.com/xnzyBi9.png" rel="shortcut icon"/>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div class="dashboard-container">
    <%- include('../partials/user-nav.ejs', { user, page }) %>
    
    <main class="dashboard-content">
      <!-- Forex Ticker -->
      <div class="forex-ticker" id="forexTicker">
        <div class="ticker-content" id="tickerContent">
          <div class="ticker-item"><span>EUR/USD:</span><span class="up">1.0923 ↑</span></div>
          <div class="ticker-item"><span>GBP/USD:</span><span class="down">1.2712 ↓</span></div>
          <div class="ticker-item"><span>USD/JPY:</span><span class="up">148.57 ↑</span></div>
          <div class="ticker-item"><span>AUD/USD:</span><span class="down">0.6741 ↓</span></div>
          <div class="ticker-item"><span>BTC/USD:</span><span class="up">43,200.00 ↑</span></div>
          <!-- add more as needed -->
        </div>
      </div>
      
      <div class="chart-section">
        <div class="chart-header">
          <h3>Live Trading Chart</h3>
          <select id="tradingPair" class="trading-pair-select">
            <option value="EURUSD">EUR/USD</option>
            <option value="GBPUSD">GBP/USD</option>
            <option value="USDJPY">USD/JPY</option>
          </select>
        </div>
        
        <div class="chart-wrapper">
          <canvas id="tradingChart"></canvas>
        </div>
        
        <button 
          id="startTradeBtn" 
          class="start-trade-btn" 
          data-can-trade="<%= user.canTrade %>"
          <%= !user.canTrade ? 'disabled' : '' %>
        >
          Start Trade
        </button>
      </div>
      
      <div class="market-analysis">
        <h3>Market Analysis</h3>
        <div class="analysis-content">
          <div class="market-news">
            <h4>Latest Updates</h4>
            <ul class="news-list">
              <li>EUR/USD faces resistance at 1.0900 level</li>
              <li>Fed signals potential rate cuts in 2025</li>
              <li>ECB maintains hawkish stance on inflation</li>
            </ul>
          </div>
          
          <div class="technical-indicators">
            <h4>Technical Indicators</h4>
            <div class="indicator">
              <span>RSI (14)</span>
              <span class="value">56.8</span>
            </div>
            <div class="indicator">
              <span>MACD</span>
              <span class="value positive">0.0012</span>
            </div>
            <div class="indicator">
              <span>MA (200)</span>
              <span class="value">1.0865</span>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>
  
  <!-- Trade Modal -->
  <div id="tradeModal" class="modal">
    <div class="modal-content">
      <h3 class="modal-title">Start Trading</h3>
      <div class="form-group">
        <label for="signalSelect">Select Signal</label>
        <select id="signalSelect" required>
          <option value="">Choose a signal</option>
          <option value="EURUSD">EUR/USD</option>
          <option value="GBPUSD">GBP/USD</option>
          <option value="USDJPY">USD/JPY</option>
          <option value="USDCHF">USD/CHF</option>
        </select>
      </div>
      <div class="form-group">
        <label for="tradeAmount">Amount ($)</label>
        <input 
          type="number" 
          id="tradeAmount" 
          min="500" 
          step="0.01" 
          placeholder="Minimum $500.00"
          required
        >
      </div>
      <div class="modal-buttons">
        <button onclick="confirmTrade()" class="btn btn-primary">Confirm</button>
        <button onclick="closeModal('tradeModal')" class="btn btn-secondary">Cancel</button>
      </div>
    </div>
  </div>
  
  <!-- Success Modal -->
  <div id="successModal" class="modal">
    <div class="modal-content"></div>
  </div>
  
  <!-- Error Modal -->
  <div id="errorModal" class="modal">
    <div class="modal-content">
      <h3 class="modal-title">Error</h3>
      <p class="modal-message"></p>
      <button onclick="closeModal('errorModal')" class="btn btn-primary">OK</button>
    </div>
  </div>
  <script>
    const newsList = document.querySelector(".news-list");
    const newsItems = Array.from(newsList.children);
    let currentNews = 0;
  
    function cycleNews() {
      newsItems.forEach((item, i) => {
        item.style.opacity = i === currentNews ? "1" : "0";
        item.style.transition = "opacity 1s ease";
        item.style.position = "absolute";
      });
  
      currentNews = (currentNews + 1) % newsItems.length;
    }
  
    function initNewsTicker() {
      newsList.style.position = "relative";
      newsList.style.height = "1.5em";
      setInterval(cycleNews, 3000);
    }
  
    document.addEventListener("DOMContentLoaded", initNewsTicker);
  </script>
  
  <script src="/js/trade.js"></script>
  <script src="../js/dashboard.js"></script>
</body>
</html>